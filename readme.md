# thread包

模式高并发 qps

客户端每秒钟向服务端发1000次请求





QPS：单个进程每秒钟处理完请求的次数；注意这里是处理完。具体是指发出请求到服务器处理完成功返回结果。



tcp链路建立完成，在客户端调用channelActive，将当前系统时间发送给服务端，
到客户端调用channelRead0的时候，在获取当前的时间减去服务端发过来的时间（即客户端一开始发送的的时间戳）就是时间差，就是本次请求的**响应时间**，

简言之：响应时间客户端接收时间戳-客户端发送时间戳



QPS = 总的并发数量/总的时间

平均响应时间 = 总的响应时间/总的并发数


## 调优
- 阻塞代码交给线程池处理
- netty自带的线程池


# connection包

模拟百万连接

1024 一下的端口留给root 使用 ，所以客户端只能从1025-65535发送端口，也就6万次，根本达不到一百万次

服务端开20个端口，每个服务端都去连这20个端口 一共120万次。

在服务端本地开20个端口 

while 去创建本地的连接连接远程的20个端口，本地能创建60000个客户端，60000*20=120 0000个连接。

这里需要注意句柄的问题，所以需要通过动态的修改句柄，完成调优，才能将这个进行完成的演示，否则会报错 Too many open file